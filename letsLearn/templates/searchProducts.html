<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Search Products | BurnLab</title>

<style>
:root {
  --burn-dark: #1a2a46;
  --burn-mid: #23395d;
  --burn-accent: #007bff;
  --burn-light: #9ec5ff;
  --burn-bg: #f4f6f8;
}

body {
  font-family: "Segoe UI", sans-serif;
  background-color: var(--burn-bg);
  margin: 0;
  padding: 0;
}

header {
  background-color: var(--burn-mid);
  color: white;
  text-align: center;
  padding: 1.2rem;
  font-size: 1.4rem;
  font-weight: bold;
}

/* Layout */
main {
  max-width: 900px;
  margin: 40px auto;
  background: #fff;
  padding: 25px;
  border-radius: 10px;
  box-shadow: 0 0 12px rgba(0,0,0,0.1);
}

/* Search Bar */
form {
  display: flex;
  flex-direction: column;
  gap: 14px;
  margin-bottom: 25px;
}

form .row-flex {
  display: flex;
  gap: 10px;
}

input[type="text"] {
  flex: 1;
  padding: 12px;
  border-radius: 5px;
  border: 1px solid #ccc;
}

button {
  background-color: var(--burn-accent);
  border: none;
  color: white;
  padding: 12px 20px;
  border-radius: 5px;
  cursor: pointer;
  font-weight: bold;
}
button:hover { background-color: #0056b3; }

/* Tag checkboxes */
.tag-box {
  background: #f9f9fb;
  border: 1px solid #ccc;
  padding: 12px;
  border-radius: 8px;
}

.tag-box strong {
  display: block;
  margin-bottom: 8px;
  color: var(--burn-mid);
}

.tag-box label {
  margin-right: 10px;
  font-size: 14px;
}

/* Product card */
.product {
  display: flex;
  gap: 15px;
  padding: 15px 0;
  border-bottom: 1px solid #ddd;
}
.product:last-child { border-bottom: none; }

.product-info { flex: 1; }

.product h3 {
  margin: 0 0 6px 0;
  color: var(--burn-mid);
}

.price {
  font-weight: bold;
  color: var(--burn-accent);
  margin: 5px 0;
}

/* Tag badge */
.tag-badge {
  display: inline-block;
  background: var(--burn-accent);
  color: white;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 12px;
  margin-right: 5px;
  margin-top: 3px;
}

a.details-btn {
  text-decoration: none;
  font-weight: bold;
  color: var(--burn-accent);
}
a.details-btn:hover { color: #0056b3; }
</style>
</head>

<body>

<header>BurnLab Product Search</header>

<main>

  <form method="get" action="/searchProducts/">

    <div class="row-flex">
      <input type="text" name="q" placeholder="Search for a product..." value="{{ query }}">
      <button type="submit">Search</button>
    </div>

    <!-- ⭐ Tag Filtering Section ⭐ -->
    <div class="tag-box">
      <strong>Filter by Tags:</strong>

      {% for tag in tags %}
        <label>
          <input type="checkbox" name="tags"
                 value="{{ tag.id }}"
                 {% if tag.id|stringformat:"s" in selected_tags %}checked{% endif %}>
          {{ tag.name }}
        </label>
      {% empty %}
        <p style="color:#888;">No tags available.</p>
      {% endfor %}
    </div>

  </form>

  {% if search_performed %}
    {% if products %}
      {% for product in products %}

      <div class="product">
        <div style="width:90px; height:90px; background:#e6eefc; border-radius:8px;"></div>

        <div class="product-info">
          <h3>{{ product.title }}</h3>
          <p>{{ product.description }}</p>

          <!-- Price -->
          <p class="price">$ {{ product.display_price }}</p>

          <!-- ⭐ Display tags for each product ⭐ -->
          <p>
            {% for t in product.tags.all %}
              <span class="tag-badge">{{ t.name }}</span>
            {% empty %}
              <span style="color:#aaa; font-size: 13px;">No tags</span>
            {% endfor %}
          </p>

          <a class="details-btn" href="/details/?product_id={{ product.id }}">View Details →</a>
        </div>
      </div>

      {% endfor %}
    {% else %}
      <p>No matching products found.</p>
    {% endif %}
  {% endif %}

</main>

</body>
</html>

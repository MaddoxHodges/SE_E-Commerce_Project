<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BurnLab â€“ Seller Orders</title>

<style>
:root {
  --burn-dark: #1a2a46;
  --burn-mid: #23395d;
  --burn-accent: #007bff;
  --burn-light: #9ec5ff;
  --burn-bg: #f5f8fc;
}

body {
  margin: 0;
  font-family: "Source Sans Pro", sans-serif;
  background: var(--burn-bg);
  color: #2b2b2b;
}

header {
  background: var(--burn-mid);
  color: #fff;
  text-align: center;
  padding: 1.4rem 0;
  font-size: 1.5rem;
  font-weight: bold;
}

nav {
  background: var(--burn-dark);
  display: flex;
  justify-content: center;
  gap: 1.5rem;
  padding: 0.9rem 1rem;
}

nav a {
  color: var(--burn-light);
  text-decoration: none;
  font-weight: 600;
  transition: .2s;
}

nav a:hover {
  color: #fff;
}

.container {
  width: 85%;
  max-width: 920px;
  margin: 30px auto;
}

.orders-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
  background: #fff;
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid #ddd;
}

.orders-table th {
  background: var(--burn-mid);
  color: white;
  padding: 12px;
  font-size: 14px;
}

.orders-table td {
  padding: 12px;
  text-align: center;
  border-bottom: 1px solid #eee;
}

.orders-table tr:hover {
  background: #eef4ff;
}

h2 {
  text-align:center;
  margin-top: 50px;
}

.view-btn, .reply-btn {
  background: var(--burn-accent);
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  text-decoration: none;
}

.view-btn:hover, .reply-btn:hover {
  opacity: .8;
}

.no-data {
  text-align: center;
  color: #777;
  padding: 15px;
}
</style>
</head>
{if user.is_authenticated and user.is_seller %}
<body>

<header>BurnLab Seller Orders</header>

<nav>
  <a href="/productPage/">Products</a>
  <a href="/newListing/">New Listing</a>
  <a href="/logout/">Logout</a>
</nav>

<div class="container">

  <h2>Orders Containing Your Products</h2>

<table class="orders-table">
<tr>
  <th>Order ID</th>
  <th>Date</th>
  <th>Title</th>
  <th>Quantity</th>
  <th>Total</th>
  <th>Status</th>
  <th>Payment Received</th>
</tr>

{% for i in items %}
<tr>
  <td>{{ i.order_id.id }}</td>
  <td>{{ i.order_id.created_at }}</td>
  <td>{{ i.product_id.title }}</td>
  <td>{{ i.qty }}</td>
  <td>${{ i.formatted_price }}</td>
  <td>{{ i.order_id.get_status_display }}</td>
  <td> {{ i.seller_paid }}
  </td>
</tr>
{% empty %}
<tr><td colspan="4"><i>No orders found.</i></td></tr>
{% endfor %}

  <table class="orders-table">
    <thead>
      <tr>
        <th>Order ID</th>
        <th>Buyer</th>
        <th>Reason</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% if refunds %}
        {% for r in refunds %}
          <tr>
            <td>{{ r.id }}</td>
            <td>{{ r.user.username }}</td>
            <td>{{ r.refund_reason|default:"No reason provided" }}</td>
            <td>
              {% if r.status == 'R' %}
                Pending Seller
              {% elif r.status == 'C' %}
                Closed
              {% elif r.status == 'F' %}
                Denied
              {% else %}
                {{ r.get_status_display }}
              {% endif %}
            </td>
            <td>
              {% if r.refund_ticket %}
                <a href="/replyTicket/{{ r.refund_ticket.id }}/" class="reply-btn">Reply</a>
              {% else %}
                <span style="color:gray;">No ticket linked</span>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      {% else %}
        <tr><td colspan="5" class="no-data">No refund requests found.</td></tr>
      {% endif %}
    </tbody>
  </table>

<p>
  Total Payout: ${{ sum_total }}
  <a href="/sellerPayout/">
    <button class="view-btn">Receive Payout</button>
  </a>
</p>

</div>
{% else %}
  <script>
    window.location.href = "/home";
  </script>
{% endif %}
</body>
</html>
